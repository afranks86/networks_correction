---
title: "Significance of improved precision without significant loss in recall -- WGCNA networks using canonical pathway databases"
output:
  html_document:
    code_folding: hide
---
```{r}
## load library
library(knitr)
library(kableExtra)

## load data
load("/work-zfs/abattle4/parsana/networks_correction/publication_figures/fig2/fig2.RData")
	fig2 <- list(blood = plot.blood, lung = plot.lung, muscle = plot.muscle, sub = plot.sub, thyroid = plot.thyroid)

## Precision and Recall ( Uncorrected vs PC corrected)
	precision <- lapply(fig2, function(x){
		eachtissue <- split(x, x$type)
		tmp.pval <- wilcox.test(eachtissue[[1]]$precision, eachtissue[[8]]$precision, alternative = "greater")$p.value
		})

	recall <- lapply(fig2, function(x){
		eachtissue <- split(x, x$type)
		tmp.pval <- wilcox.test(eachtissue[[1]]$recall, eachtissue[[8]]$recall, alternative = "less")$p.value
		})
	pc.corrected <- data.frame(cbind(precision, recall))

## Precision and Recall (Uncorrected vs half-PC corrected)
	precision <- lapply(fig2, function(x){
		eachtissue <- split(x, x$type)
		tmp.pval <- wilcox.test(eachtissue[[2]]$precision, eachtissue[[8]]$precision, alternative = "greater")$p.value
		})

	recall <- lapply(fig2, function(x){
		eachtissue <- split(x, x$type)
		tmp.pval <- wilcox.test(eachtissue[[2]]$recall, eachtissue[[8]]$recall, alternative = "less")$p.value
		})
	halfpc.corrected <- data.frame(cbind(precision, recall))

## Precision and Recall (Uncorrected vs quarter-PC corrected)
	precision <- lapply(fig2, function(x){
		eachtissue <- split(x, x$type)
		tmp.pval <- wilcox.test(eachtissue[[3]]$precision, eachtissue[[8]]$precision, alternative = "greater")$p.value
		})

	recall <- lapply(fig2, function(x){
		eachtissue <- split(x, x$type)
		tmp.pval <- wilcox.test(eachtissue[[3]]$recall, eachtissue[[8]]$recall, alternative = "less")$p.value
		})
	quarterpc.corrected <- data.frame(cbind(precision, recall))

merged.table <- cbind(pc.corrected, halfpc.corrected, quarterpc.corrected)

kable(merged.table, "html") %>%
  kable_styling() %>%
  add_header_above(c(" " = 1, "PC corrected" = 2, "half-PC corrected" = 2, "quarter-PC corrected" = 2))
```
